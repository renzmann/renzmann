#!/usr/bin/env bash
_install_nvim() {
	local version=${1:-"0.7.0"}
	local download_url="https://github.com/neovim/neovim/releases/download/v${version}"

	case $OSTYPE in
		'darwin'*)
			curl -sSL "${download_url}/nvim-macos.tar.gz" --output "$HOME/nvim-macos.tar.gz" \
				&& tar xzvf "$HOME/nvim-macos.tar.gz" \
				&& mv nvim-osx64 $HOME \
				&& ln -nsf "$HOME/nvim-osx64/bin/nvim" "$HOME/.local/bin/nvim"
			;;
		*)
			curl -LO "${download_url}/nvim.appimage" \
				&& chmod u+x nvim.appimage \
				&& mv nvim.appimage "$HOME/.local/bin/nvim"
			;;
	esac

	nvim-packagesync
}

_install_nvim "$@"
